[package]
name = "gllm-kernels"
version = "0.1.0"
edition = "2021"
authors = ["gllm contributors"]
license = "MIT"
description = "Low-level attention kernels for gllm"
repository = "https://github.com/putao520/gllm"
keywords = ["attention", "kernels", "burn", "gpu", "tensor"]
categories = ["algorithms", "science"]

[lib]
name = "gllm_kernels"
path = "src/lib.rs"

[features]
default = ["cpu"]
cpu = ["burn-ndarray"]
cuda = ["burn-cuda"]
wgpu = ["burn-wgpu"]
fusion = ["burn/fusion", "burn-fusion"]
nccl = ["cudarc", "cuda"]
# hip 等 burn 支持后再加

[dependencies]
burn = { version = "0.16", default-features = false }
burn-ndarray = { version = "0.16", optional = true }
burn-cuda = { version = "0.16", optional = true }
burn-wgpu = { version = "0.16", optional = true }
burn-fusion = { version = "0.16", optional = true }
log = "0.4"
crossbeam-channel = "0.5"
cudarc = { version = "0.12", optional = true, features = ["nccl"] }

[dev-dependencies]
criterion = "0.5"

[[bench]]
name = "attention_bench"
harness = false
