[package]
name = "gllm-kernels"
version = "0.3.0"
edition = "2021"
description = "High-performance GPU/CPU inference kernels for LLMs"
authors = ["gllm contributors"]
license = "Apache-2.0"

[features]
default = []
# Placeholder for future NCCL support (multi-GPU communication)
nccl = []

[dependencies]
# --- Core Compute ---
# GPU: Safe wrapper for CUDA Driver API (no runtime/nvrtc)
cudarc = { version = "0.18", default-features = false, features = ["driver", "dynamic-loading", "cuda-12060"] }

# CPU: Pure Rust SIMD Linear Algebra (AVX2/AVX-512/NEON)
faer = "0.21"

# Data Types
half = { version = "2.3", features = ["bytemuck", "num-traits", "serde"] }
bytemuck = { version = "1.14", features = ["derive", "min_const_generics"] }

# --- Utilities ---
thiserror = "1.0"
log = "0.4"
rayon = "1.8"       # CPU parallelization
once_cell = "1.19"  # Global singleton

[dev-dependencies]
criterion = "0.5"
tokio = { version = "1.36", features = ["full"] }
